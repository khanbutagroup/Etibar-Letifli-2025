{% extends "base.html" %}
{% load static %}
{% load i18n %}

{% block meta %}

<title>{{ meta.title|default:"Default Title" }}</title>
<meta name="description" content="{{ meta.description|default:'Default description' }}">
<meta name="keywords" content="{{ meta.keywords|default:'keyword1, keyword2' }}">

{% endblock %}
{% block css %}
    <!-- Google Fonts Link -->
    <link rel="preconnect" href="https://fonts.googleapis.com/" />
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@100..900&amp;family=Rubik:ital,wght@0,300..900;1,300..900&amp;display=swap"
      rel="stylesheet"
    />

    <!-- Bootstrap CSS Link -->
    <link
      rel="stylesheet"
      type="text/css"
      href="{% static 'assets/css/bootstrap.min.css' %}"
    />

    <!-- Swiper Slider CSS Link -->
    <link
      rel="stylesheet"
      type="text/css"
      href="{% static 'assets/css/swiper-bundle.min.css' %}"
    />

    <!-- Font Awesome CSS Link -->
    <link
      rel="stylesheet"
      type="text/css"
      href="{% static 'assets/css/fontawesome.min.css' %}"
    />

    <!-- Wow Animation CSS Link -->
    <link rel="stylesheet" type="text/css" href="{% static 'assets/css/animate.css' %}" />

    <!-- Main Style CSS Link -->
    <link rel="stylesheet" type="text/css" href="{% static 'assets/css/style.css' %}" />
  </head>
{% endblock %}
{% block main %}

    <!-- Banner Start -->
    <section class="inner-banner">
      <div class="main-banner-bg-shape">
        <div class="shape-1"></div>
        <div class="shape-2"></div>
      </div>
      <div class="inner-banner-bg-aliment-wp">
        <div class="bg-aliment-3 zoom-fade-animation">
          <img
            src="{% static 'assets/images/aliment-03.svg' %}"
            width="44"
            height="44"
            alt="Aliment"
          />
        </div>

        <div class="bg-aliment-6 zoom-fade-animation">
          <img
            src="{% static 'assets/images/aliment-03.svg' %}"
            width="44"
            height="44"
            alt="Aliment"
          />
        </div>

        <div class="bg-aliment-9 zoom-fade-animation">
          <img
            src="{% static 'assets/images/aliment-03.svg' %}"
            width="29"
            height="29"
            alt="Aliment"
          />
        </div>
      </div>
      <div class="container">
        <div class="row">
          <div class="col-lg-12">
            <div class="banner-content text-center">
              <h1 class="h1-title">{% trans 'Hesabım' %}</h1>
              <div class="banner-breadcrum">
                <ul>
                  <li><a href="{% url 'index' %}" title="Home">{% trans 'Ana səhifə' %}</a></li>
                  <li><i class="fa-solid fa-angle-right"></i></li>
                  <li>{% trans 'Hesabım' %}</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- Banner End -->

    <!-- Contact Us Start -->

    <div class="main_content_area mt-30 mb-50">
      <div class="container">
        <div class="account_dashboard">
          <div class="row">
            <div class="col-sm-12 col-md-3 col-lg-3">
              <!-- Nav tabs -->
              <div class="dashboard_tab_button">
                <ul role="tablist" class="nav flex-column dashboard-list">
                  <li>
                    <a
                      href="#account-details"
                      data-bs-toggle="tab"
                      class="nav-link active"
                      aria-selected="true"
                      role="tab"
                      >{% trans 'Hesabım' %}
                    </a>
                  </li>
                  <!-- <li>
                    <a
                      href="#orders"
                      data-bs-toggle="tab"
                      class="nav-link"
                      aria-selected="false"
                      role="tab"
                      >Sifarişlərim
                    </a>
                  </li> -->
                  <li>
                    <a
                      href="#videos"
                      data-bs-toggle="tab"
                      class="nav-link"
                      aria-selected="false"
                      role="tab"
                      >{% trans 'Video dərslərim' %}
                    </a>
                  </li>
                  <li>
                    <a
                      href="#exams"
                      data-bs-toggle="tab"
                      class="nav-link"
                      aria-selected="false"
                      role="tab"
                      >{% trans 'İmtahanlarım' %}
                    </a>
                  </li>
                  <li>
                    <a
                      href="#results"
                      data-bs-toggle="tab"
                      class="nav-link"
                      aria-selected="false"
                      role="tab"
                      >{% trans 'Nəticələrim' %}
                    </a>
                  </li>
                  <li>
                    <a
                      href="{% url 'logout' %}"
                      class="nav-link"
                      aria-selected="false"
                      role="tab"
                      >{% trans 'Çıxış et' %}</a
                    >
                  </li>
                </ul>
              </div>
            </div>
            <div class="col-sm-12 col-md-9 col-lg-9">
              <!-- Tab panes -->
              <div class="tab-content dashboard_content">
                <!-- Videos -->
                <div class="tab-pane fade" id="videos" role="tabpanel">
                  <h3>{% trans 'Video dərslərim' %}</h3>
                  <div class="orders-600">
                    <div class="row video-area">
                      
                      {% for i in videos %}
                        <div class="col-lg-6 mb-3">
                          <div class="common-post-card">
                            <div
                              class="post-image-box-wp video-layer"
                              data-video="{{ i.video.url }}"
                            >
                              <div class="post-image pdf-image">
                                <img
                                  src="{{ i.image.url }}"
                                  width="356"
                                  height="230"
                                  alt="Course Image"
                                />
                              </div>
                              <div class="post-tag video-tag">
                                <span><i class="fa fa-play"></i></span>
                              </div>
                            </div>
                            <div class="common-post-content">
                              <div class="post-content-title">
                                <span>
                                  <h4 class="h4-title">{{ i.title }}</h4>
                                </span>
                              </div>
                            </div>
                          </div>
                        </div>
                      {% endfor %}

                      
                    </div>
                  </div>
                </div>
                <!-- Exams -->
                <div class="tab-pane fade" id="exams" role="tabpanel">
                  <h3>{% trans 'İmtahanlarım' %}</h3>
                  <div class="orders-600">
                    <table
                      class="table first-table order-table"
                      cellspacing="0"
                    >
                      <thead>
                        <tr>
                          <th class="product-name order-product-name">
                            {% trans 'İmtahan adı' %}
                          </th>
                          <th class="product-price order-procut-price">
                            {% trans 'Qiymət' %}
                          </th>

                          <th class="order-date">{% trans 'Tarix' %}</th>
                        </tr>
                      </thead>
                      <tbody>
                        {% for i in purchased_exams %}
                            <tr class="product-box-container">
                              <td class="product-name-container">
                                <a
                                  
                                  class="text-gray-90 card-text order-text-name order-text-width"
                                >
                                  {{ i.exam.title }}
                                </a>
                              </td>
                              <td class="product-price order-product-price">
                                <span>
                                 
                                  {{ i.exam.price }}<span class="azn">₼</span>
                                </span>
                              </td>

                              <td class="order-date"><span>{{ i.purchased_at|date:" d.m.Y H:i" }}</span></td>
                              <td class="order-date">
                                {% if i.exam.get_status_text == "İmtahana başla" %}
                                  <a href="{% url 'start_exam' i.exam.id %}" class="start-btn sec-btn">
                                    {% trans 'İmtahana başla' %}
                                  </a>
                                {% else %}
                                  <p style="color: gray;">{{ i.exam.get_status_text }}</p>
                                {% endif %}
                              </td>
                            </tr>
                        {% endfor %}
                      </tbody>
                    </table>
                  </div>
                </div>

                <!-- RESULTS -->
                <div class="tab-pane fade" id="results" role="tabpanel">
                  <h3>{% trans 'Nəticələrim' %}</h3>
                  <div class="orders-600">
                    <table class="table first-table order-table" cellspacing="0">
                      <thead>
                        <tr>
                          <th>{% trans 'İmtahan adı' %}</th>
                          <th>{% trans 'Qiymət' %}</th>
                          <th>{% trans 'Tarix' %}</th>
                          <th>{% trans 'Nəticə' %}</th>
                        </tr>
                      </thead>
                      <tbody>
                        {% for session in sessions %}
                        <tr>
                          <td>{{ session.exam.title }}</td>
                          <td>
                            {% if session.exam.price %}
                              {{ session.exam.price }} ₼
                            {% else %}
                              -
                            {% endif %}
                          </td>
                          <td>
                            {% if session.finished_at %}
                              {{ session.finished_at|date:"d.m.Y H:i" }}
                            {% else %}
                              {% trans 'Davam edir' %}
                            {% endif %}
                          </td>
                          <td>
                            {% if session.finished_at %}
                              <a href="{% url 'exam_finish' session.id %}" class="start-btn sec-btn">
                                {% trans 'Nəticənə bax' %}
                              </a>
                            {% else %}
                              <span class="text-muted">{% trans 'Bitməyib' %}</span>
                            {% endif %}
                          </td>
                        </tr>
                        {% empty %}
                        <tr>
                          <td colspan="4" class="text-center text-muted">
                            {% trans 'Hələ heç bir imtahan nəticəniz yoxdur.' %}'
                          </td>
                        </tr>
                        {% endfor %}
                      </tbody>
                    </table>
                  </div>
                </div>

                <!-- Account details -->
                <div
                  class="tab-pane fade show active"
                  id="account-details"
                  role="tabpanel"
                >
                  <h3 class="fz-product-details__title">{% trans 'Hesab detalları' %}</h3>
                  <div class="login">
                    <div class="login_form_container">
                      <div class="account_login_form">
                        <form action="#">
                          <div class="account_content">
                            <div class="row">
                              <div class="col-6">
                                <label>{% trans 'Ad' %}</label>
                                <input
                                  type="text"
                                  name="first_name"
                                  value="{% trans 'Fərid' %}"
                                />
                              </div>
                              <div class="col-6">
                                <label>{% trans 'Soyad' %}</label>
                                <input
                                  type="text"
                                  name="last_name"
                                  value="{% trans 'Rzazadə' %}"
                                />
                              </div>
                              <div class="col-6 phone-div">
                                <label>{% trans 'Əlaqə nömrəsi' %}</label>
                                <div class="input-group">
                                  <span class="countrycode">+994</span>
                                  <input
                                    type="text"
                                    class="form-input"
                                    placeholder="(55) 555-55-55"
                                    id="phone"
                                    name="phone"
                                    value=""
                                  />
                                </div>
                              </div>
                              <div class="save_button col-6">
                                <button type="submit">{% trans 'Yadda saxla' %}</button>
                              </div>
                            </div>
                          </div>

                          <div class="account_reset_password ml-0 mt-4 mb-4">
                            <h3 class="fz-product-details__title">
                              {% trans 'Şifrəni dəyişdir' %}
                            </h3>
                            <div class="col-md-6 col-12 pass-area">
                              <input
                                type="password"
                                name="register-password"
                                id="register-password"
                                placeholder="{% trans 'Şifrə' %}"
                              />
                              <div class="icon-holder">
                                <i
                                  class="fa fa-eye-slash"
                                  aria-hidden="true"
                                ></i>
                              </div>
                            </div>
                            <div class="col-md-6 col-12 pass-area">
                              <input
                                type="password"
                                name="register-repeat-password"
                                id="register-repeat-password"
                                placeholder="{% trans 'Təkrar şifrə' %}"
                              />
                              <div class="icon-holder">
                                <i
                                  class="fa fa-eye-slash"
                                  aria-hidden="true"
                                ></i>
                              </div>
                            </div>

                            <div class="col-6 save_button">
                              <button type="submit">{% trans 'Yadda saxla' %}</button>
                            </div>
                          </div>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Contact Us End -->


    <!-- Modal -->
    <!-- Modal -->
    <div class="video-modal-area">
      <div id="videoModal" class="modal" style="display:none;">
        <span class="close">&times;</span>
        <div class="modal-content">
          <!-- Video JS ilə bura əlavə olunacaq -->
        </div>
      </div>
    </div>
{% endblock %}
{% block js %}
    <!-- Back To Top Start -->
    <div class="scroll-to-top">
      <svg
        class="progress-circle svg-content"
        width="100%"
        height="100%"
        viewBox="-1 -1 102 102"
      >
        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"></path>
      </svg>
    </div>
    <!-- Back To Top End -->

    <!-- Jquery JS Link -->

    <script src="{% static 'assets/js/jquery-3.7.1.min.js' %}"></script>

    <!-- Bootstrap JS Link -->
    <script src="{% static 'assets/js/bootstrap.min.js' %}"></script>

    <!-- Swiper Slider JS Link -->
    <script src="{% static 'assets/js/swiper-bundle.min.js' %}"></script>

    <!-- Bg Moving JS Link -->
    <script src="{% static 'assets/js/bg-moving.js' %}"></script>

    <!-- Wow Animation JS Link -->
    <script src="{% static 'assets/js/wow.min.js' %}"></script>

    <!-- Custom JS Link -->
    <script src="{% static 'assets/js/custom.js' %}"></script>

    <!-- Back To Top JS Link -->
    <script src="{% static 'assets/js/back-to-top.js' %}"></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const modal = document.getElementById('videoModal');
  const modalContent = modal.querySelector('.modal-content');
  const closeBtn = modal.querySelector('.close');
  let activeVideo = null;

  // Bütün video kartlarını seçirik
  document.querySelectorAll('.post-image-box-wp').forEach(item => {
    item.addEventListener('click', function () {
      const videoUrl = this.getAttribute('data-video');
      if (!videoUrl) return;

      // Əvvəlki videonu təmizlə
      if (activeVideo) {
        activeVideo.pause();
        activeVideo.remove();
      }

      // Yeni video elementi yarat
      const video = document.createElement('video');
      video.src = videoUrl;
      video.controls = true;
      video.autoplay = true;
      video.style.width = '100%';
      video.style.height = '450px';
      video.style.borderRadius = '10px';

      // Modalın içərisinə əlavə et
      modalContent.appendChild(video);
      activeVideo = video;

      // Modalı göstər
      modal.style.display = 'flex';
      modal.style.alignItems = 'center';
      modal.style.justifyContent = 'center';
      document.body.style.overflow = 'hidden';
    });
  });

  // Modalı bağlama funksiyası
  function closeModal() {
    modal.style.display = 'none';
    document.body.style.overflow = '';
    if (activeVideo) {
      activeVideo.pause();
      activeVideo.remove();
      activeVideo = null;
    }
  }

  // ✕ düyməsinə kliklə bağla
  closeBtn.addEventListener('click', closeModal);

  // Arxa fon kliklənəndə bağla
  window.addEventListener('click', function (e) {
    if (e.target === modal) closeModal();
  });
});
</script>
<style>
.modal {
  position: fixed;
  z-index: 9999;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.8);
  display: none;
  align-items: center;
  justify-content: center;
}
.modal-content {
  background: transparent;
  max-width: 900px;
  width: 80%;
  padding: 10px;
}
.close {
  position: absolute;
  right: 30px;
  top: 20px;
  font-size: 35px;
  color: white;
  cursor: pointer;
  z-index: 10000;
}
.video-layer {
  cursor: pointer;
}
</style>


{% endblock %}